import{c as J,d as K,g as T,h as X,i as Y}from"./chunk-6XXA7HXI.js";import{b as $,c as ee,d as te,e as re,f as ie,g as oe,h as ne,i as ae,j as se,k as le,l as ce,m as me,o as pe,p as de}from"./chunk-475LJLXS.js";import{a as S,b as ue}from"./chunk-WAGNSJXM.js";import{a as u,e as n,l as Z}from"./chunk-EA7DF43O.js";import{B as _,C as b,Da as l,I as c,M as E,N as o,O as N,Oa as z,S as I,T as L,X as D,Z as h,aa as p,ba as v,ca as a,d as B,da as s,ea as H,fa as M,ga as k,ha as P,la as G,ma as j,na as d,oa as w,qa as q,ra as A,sa as R,ta as O,va as Q,w as U,wa as W,y as m}from"./chunk-NFTVRMM5.js";var we=n("p-6 pt-0",{variants:{},defaultVariants:{}});var Ce=n("text-sm text-muted-foreground",{variants:{},defaultVariants:{}}),y=class i{userClass=c("",{alias:"class"});_computedClass=l(()=>u(Ce(),this.userClass()));static \u0275fac=function(e){return new(e||i)};static \u0275dir=m({type:i,selectors:[["","hlmCardDescription",""]],hostVars:2,hostBindings:function(e,t){e&2&&p(t._computedClass())},inputs:{userClass:[1,"class","userClass"]},standalone:!0})};var Ue=n("flex p-6 pt-0",{variants:{direction:{row:"flex-row items-center space-x-1.5",column:"flex-col space-y-1.5"}},defaultVariants:{direction:"row"}});var he=n("flex p-6",{variants:{direction:{row:"flex-row items-center space-x-1.5",column:"flex-col space-y-1.5"}},defaultVariants:{direction:"column"}}),g=class i{userClass=c("",{alias:"class"});_computedClass=l(()=>u(he({direction:this.direction()}),this.userClass()));direction=c("column");static \u0275fac=function(e){return new(e||i)};static \u0275dir=m({type:i,selectors:[["","hlmCardHeader",""]],hostVars:2,hostBindings:function(e,t){e&2&&p(t._computedClass())},inputs:{userClass:[1,"class","userClass"],direction:[1,"direction"]},standalone:!0})};var ve=n("text-lg font-semibold leading-none tracking-tight",{variants:{},defaultVariants:{}}),V=class i{userClass=c("",{alias:"class"});_computedClass=l(()=>u(ve(),this.userClass()));static \u0275fac=function(e){return new(e||i)};static \u0275dir=m({type:i,selectors:[["","hlmCardTitle",""]],hostVars:2,hostBindings:function(e,t){e&2&&p(t._computedClass())},inputs:{userClass:[1,"class","userClass"]},standalone:!0})};var ye=n("rounded-lg border border-border bg-card focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 text-card-foreground shadow-sm",{variants:{},defaultVariants:{}}),x=class i{userClass=c("",{alias:"class"});_computedClass=l(()=>u(ye(),this.userClass()));static \u0275fac=function(e){return new(e||i)};static \u0275dir=m({type:i,selectors:[["","hlmCard",""]],hostVars:2,hostBindings:function(e,t){e&2&&p(t._computedClass())},inputs:{userClass:[1,"class","userClass"]},standalone:!0})};var ge=()=>["/"];function Ve(i,r){i&1&&(a(0,"hlm-error"),d(1,"Phone number is required."),s())}function xe(i,r){i&1&&(a(0,"hlm-error"),d(1,"Invalid phone number provided."),s())}function _e(i,r){if(i&1&&D(0,Ve,2,0,"hlm-error")(1,xe,2,0,"hlm-error"),i&2){P();let e=O(6);v(e.hasError("required")?0:-1),o(),v(e.hasError("invalid")?1:-1)}}function be(i,r){if(i&1&&(a(0,"section",5)(1,"div",7),H(2,"img",8),a(3,"div",9)(4,"h3",10),d(5),s(),a(6,"p",11),d(7),s(),a(8,"span"),d(9),s(),a(10,"p",11),d(11),s()()()()),i&2){let e=r,t=P();h("@fadeIn",void 0),o(2),h("src",e.image_url,E)("alt",e.first_name+" "+e.surname),o(3),q("",e.first_name," ",e.surname,""),o(2),w(e.country_code),o(2),w(t.flagEmoji()),o(2),w(e.phone_number)}}var De=J("fadeIn",[X("void",T({opacity:0})),Y(":enter",[K("500ms ease-in",T({opacity:1}))])]),fe=class i{constructor(r,e){this.sendService=r;this.router=e;this.sendService.clearTargetUser(),this.targetUser=this.sendService.getTargetUser()}loading=I(!1);phoneNumberGroup=new ie({phoneNumber:new oe("",[ee.required])});targetUser;submitButton=L.required(S);flagEmoji=l(()=>{let r=this.targetUser();if(!r?.country_code)return null;let e=r.country_code.toUpperCase().split("").map(t=>127462+t.charCodeAt(0)-65);return String.fromCodePoint(...e)});lookupPhoneNo(){return B(this,null,function*(){let r=this.phoneNumberGroup.controls.phoneNumber,e=r.value;if(this.targetUser()?.phone_number!==e){if(!this.phoneNumberGroup.valid||!e){this.sendService.clearTargetUser();return}this.loading.set(!0);try{let t=yield this.sendService.lookupPhoneNo(e);if(!t){r.setErrors({invalid:"User not found"});return}this.sendService.setTargetUser(t),this.submitButton().focus()}catch(t){this.sendService.clearTargetUser(),console.error("error",t),r.setErrors({invalid:"User not found"})}finally{this.loading.set(!1)}}})}next(){let r=this.targetUser();if(!this.phoneNumberGroup.valid||!r){this.phoneNumberGroup.markAsTouched();return}this.router.navigate(["/send"])}static \u0275fac=function(e){return new(e||i)(N(ue),N(z))};static \u0275cmp=U({type:i,selectors:[["app-lookup"]],viewQuery:function(e,t){e&1&&G(t.submitButton,S,5),e&2&&j()},standalone:!0,features:[Q],decls:10,vars:7,consts:[["title","Who do you want to send money to?",3,"backButtonUrl"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["hlmLabel",""],["hlmInput","","type","text","placeholder","Who do you want to send money to?","formControlName","phoneNumber",1,"w-80",3,"keydown.enter","blur"],["hlmCard","",1,"mb-4","fade-in"],[3,"loading"],["hlmCardHeader",""],["width","96","height","96",3,"src","alt"],[1,"ml-2"],["hlmCardTitle",""],["hlmCardDescription",""]],template:function(e,t){if(e&1){let f=M();H(0,"app-header",0),a(1,"form",1),k("ngSubmit",function(){return _(f),b(t.next())}),a(2,"hlm-form-field",2)(3,"label",3),d(4,"Phone number "),a(5,"input",4),k("keydown.enter",function(){return _(f),b(t.lookupPhoneNo())})("blur",function(){return _(f),b(t.lookupPhoneNo())}),s()(),A(6),D(7,_e,2,2),s(),D(8,be,12,8,"section",5),H(9,"app-submit-button",6),s()}if(e&2){let f;h("backButtonUrl",W(6,ge)),o(),h("formGroup",t.phoneNumberGroup),o(5);let C=R(t.phoneNumberGroup.controls.phoneNumber);o(),v(C.invalid&&(C.dirty||C.touched)?7:-1),o(),v((f=t.targetUser())?8:-1,f),o(),h("loading",t.loading())}},dependencies:[pe,me,ce,de,y,x,g,V,le,ne,$,te,re,ae,se,S,Z],styles:["[hlmCardHeader][_ngcontent-%COMP%]{display:flex;flex-flow:row}[hlmCardHeader][_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:25%}"],data:{animation:[De]}})};export{fe as LookupComponent,De as fadeIn};
